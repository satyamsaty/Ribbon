---
#  - name: Moving the files from localhost to active node
#    copy:
#      src: /home/ansible/sync_status.sh
#      dest: /home/satykumar/sync_status.sh
#      mode: '0777'
#      force: yes
#
#  - name: Waiting for ISBC active and standby to make a cluster
#    shell: /home/satykumar/sync_status.sh {{ mgt0IPAddress_ACTIVE }}
#    register: b
#    failed_when: b.rc not in (0,126)
#  - debug: var=b.stdout_lines
#  - name: sleep for 30 seconds and continue with play
#    wait_for:
#       timeout: 30
#
#  - name: Sync status after active and standby spawned successfully 
#    become: true
#    shell:
#      " /opt/sonus/sbx/scripts/swinfo.sh"
#    delegate_to: active-1 
#    register: a
#  - debug: var=a.stdout_lines 

  - name: Management IP
    command: "echo {{ item.mgt0ipaddress }}"
    register: result
    loop: "{{ isbc_distributed_nodes }}"
    loop_control:
       label: "{{ item.mgt0ipaddress }}"
  - debug:
      var: result
    no_log: True

  - name: name
    command: "echo {{ item.name }}"
    register: res
    loop: "{{ isbc_distributed_nodes }}"
    loop_control:
       label: "{{ item.name }}"
  - debug:
      var: res
    no_log: True



  - name: Moving the files from localhost to active node
    copy:
      src: "{{ SyncStatus_Path }}"
     # src: ../sync_status.sh
      dest: $HOME/sync_status.sh
      mode: '0777'
      force: yes
    delegate_to: "{{ res.results[0].stdout }}"


  - name: Waiting for ISBC active and standby to make a cluster
    shell: $HOME/sync_status.sh {{ result.results[0].stdout }}
    delegate_to: "{{ res.results[0].stdout }}"
    register: b
    failed_when: b.rc not in (0,126)
  - debug: var=b.stdout_lines
  - name: sleep for 30 seconds and continue with play
    wait_for:
       timeout: 30

  - name: Sync status after active and standby spawned successfully
    shell: " /opt/sonus/sbx/scripts/swinfo.sh "
    delegate_to: "{{ res.results[0].stdout }}"
    register: a
  - debug: var=a.stdout_lines

 
  
  
